<!DOCTYPE html>
<html>
<head>
    <title>Math Challenge</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #2c3e50;
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #game-container {
            text-align: center;
            padding: 20px;
            max-width: 600px;
            margin-top: 50px;
        }

        #problem {
            font-size: 48px;
            margin: 20px;
            color: #3498db;
        }

        #answer-input {
            font-size: 24px;
            padding: 10px;
            margin: 20px;
            width: 200px;
            border: none;
            border-radius: 5px;
            text-align: center;
        }

        #timer {
            font-size: 36px;
            color: #f1c40f;
            margin: 20px;
        }

        #score {
            font-size: 24px;
            margin: 20px;
        }

        .button {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            text-decoration: none;
            border: none;
            font-size: 16px;
        }

        #home-button {
            position: fixed;
            top: 20px;
            right: 20px;
        }

        #menu {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.9);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            color: white;
            z-index: 100;
        }

        .difficulty-button {
            background: #2ecc71;
            margin: 5px;
            border: none;
            color: white;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
        }

        .difficulty-button.selected {
            background: #e74c3c;
        }

        #feedback {
            font-size: 24px;
            height: 30px;
            margin: 10px;
        }

        .correct {
            color: #2ecc71;
        }

        .incorrect {
            color: #e74c3c;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .shake {
            animation: shake 0.5s;
        }

        #streak {
            font-size: 20px;
            color: #e67e22;
            margin: 10px;
        }
    </style>
</head>
<body>
    <a href="game-portal.html" class="button" id="home-button">Home</a>
    
    <div id="game-container">
        <div id="timer">60</div>
        <div id="score">Score: 0</div>
        <div id="streak">Streak: 0</div>
        <div id="problem"></div>
        <input type="number" id="answer-input" placeholder="Enter answer..." autocomplete="off">
        <div id="feedback"></div>
    </div>

    <div id="menu">
        <h2>Math Challenge</h2>
        <p>Solve math problems as quickly as you can!</p>
        <div class="difficulty-select">
            <button class="difficulty-button selected" data-level="easy">Easy</button>
            <button class="difficulty-button" data-level="medium">Medium</button>
            <button class="difficulty-button" data-level="hard">Hard</button>
        </div>
        <div class="button" onclick="startGame()">Start Game</div>
    </div>

    <script>
        const gameContainer = document.getElementById('game-container');
        const problemDisplay = document.getElementById('problem');
        const answerInput = document.getElementById('answer-input');
        const timerDisplay = document.getElementById('timer');
        const scoreDisplay = document.getElementById('score');
        const streakDisplay = document.getElementById('streak');
        const feedbackDisplay = document.getElementById('feedback');
        const menu = document.getElementById('menu');

        let score = 0;
        let streak = 0;
        let timeLeft = 60;
        let currentAnswer = 0;
        let gameInterval;
        let difficulty = 'easy';

        const difficulties = {
            easy: {
                operations: ['+', '-'],
                maxNumber: 20,
                points: 10
            },
            medium: {
                operations: ['+', '-', '*'],
                maxNumber: 50,
                points: 20
            },
            hard: {
                operations: ['+', '-', '*', '/'],
                maxNumber: 100,
                points: 30
            }
        };

        document.querySelectorAll('.difficulty-button').forEach(button => {
            button.addEventListener('click', (e) => {
                document.querySelectorAll('.difficulty-button').forEach(b => 
                    b.classList.remove('selected'));
                e.target.classList.add('selected');
                difficulty = e.target.dataset.level;
            });
        });

        function generateProblem() {
            const settings = difficulties[difficulty];
            const operation = settings.operations[Math.floor(Math.random() * settings.operations.length)];
            let num1, num2;

            if (operation === '/') {
                // Generate division problems that result in whole numbers
                num2 = Math.floor(Math.random() * 12) + 1;
                num1 = num2 * (Math.floor(Math.random() * 10) + 1);
            } else {
                num1 = Math.floor(Math.random() * settings.maxNumber) + 1;
                num2 = Math.floor(Math.random() * settings.maxNumber) + 1;
            }

            switch(operation) {
                case '+':
                    currentAnswer = num1 + num2;
                    break;
                case '-':
                    currentAnswer = num1 - num2;
                    break;
                case '*':
                    currentAnswer = num1 * num2;
                    break;
                case '/':
                    currentAnswer = num1 / num2;
                    break;
            }

            problemDisplay.textContent = `${num1} ${operation} ${num2} = ?`;
        }

        function checkAnswer() {
            const userAnswer = parseInt(answerInput.value);
            if (userAnswer === currentAnswer) {
                streak++;
                const points = difficulties[difficulty].points * (1 + Math.floor(streak / 5));
                score += points;
                feedbackDisplay.textContent = `+${points}`;
                feedbackDisplay.className = 'correct';
                generateProblem();
            } else {
                streak = 0;
                feedbackDisplay.textContent = 'Wrong!';
                feedbackDisplay.className = 'incorrect';
                answerInput.classList.add('shake');
                setTimeout(() => answerInput.classList.remove('shake'), 500);
            }
            
            scoreDisplay.textContent = `Score: ${score}`;
            streakDisplay.textContent = `Streak: ${streak}`;
            answerInput.value = '';
        }

        function startGame() {
            menu.style.display = 'none';
            score = 0;
            streak = 0;
            timeLeft = 60;
            scoreDisplay.textContent = 'Score: 0';
            streakDisplay.textContent = 'Streak: 0';
            timerDisplay.textContent = timeLeft;
            feedbackDisplay.textContent = '';
            
            generateProblem();
            answerInput.focus();

            if (gameInterval) clearInterval(gameInterval);
            gameInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = timeLeft;
                if (timeLeft <= 0) {
                    endGame();
                }
            }, 1000);
        }

        function endGame() {
            clearInterval(gameInterval);
            menu.innerHTML = `
                <h2>Game Over!</h2>
                <p>Final Score: ${score}</p>
                <div class="difficulty-select">
                    <button class="difficulty-button selected" data-level="easy">Easy</button>
                    <button class="difficulty-button" data-level="medium">Medium</button>
                    <button class="difficulty-button" data-level="hard">Hard</button>
                </div>
                <div class="button" onclick="startGame()">Play Again</div>
            `;
            menu.style.display = 'block';

            // Reattach difficulty button listeners
            document.querySelectorAll('.difficulty-button').forEach(button => {
                button.addEventListener('click', (e) => {
                    document.querySelectorAll('.difficulty-button').forEach(b => 
                        b.classList.remove('selected'));
                    e.target.classList.add('selected');
                    difficulty = e.target.dataset.level;
                });
            });
        }

        answerInput.addEventListener('keyup', (event) => {
            if (event.key === 'Enter' && answerInput.value !== '') {
                checkAnswer();
            }
        });
    </script>
</body>
</html> 